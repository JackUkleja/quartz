{"/":{"title":"Jack Ukleja","content":"\nHost your second brain and [digital garden](https://jzhao.xyz/posts/networked-thought) for free. Quartz features\n","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/allow-style-elements-tags-within-wordpress-blog-for-inline-css":{"title":"How to allow Style tag/element within your WordPress Blog for inline CSS","content":"\nIf you trust yourself enough to use the `\u003cstyle\u003e` tag within your self-hosted WordPress blog then here is how to get them to work:\n   \n* Go to your WordPress installation and locate the **wp-includes\\kses.php** file     \n* Open the file in a text editor and locate the $allowedposttags variable     \n* Paste the following snippet of code:\n```\n    'style' =\u003e array(),\n```\n* just after the line that says:\n```\n    $allowedposttags = array(\n```\nYour code should now look like the image below:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image32.png) \n\nThat gets the backend of WordPress accepting the style tag. If you write a post now and post it using [LiveWriter](http://download.live.com/writer) or the “HTML” editor in wp-admin it should get rendered out into your browser as desired.\n\nThe problem is, if you create or edit a post using the WYSIWIG “Visual” editor you will find that your style tag gets turned into a comment like so: \n  \n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image33.png) \n\nThat’s because the client side JavaScript responsible for the WYSIWYG editor is stripping out the style tag and turning it into a comment. In the default WordPress install the WYSIWYG component is called TinyMCE. Here are the instructions for hacking (that’s the spirit of php isn’t it? ;-)) TinyMCE to allow the element tag:\n  \n* Open the **wp-admin\\includes\\post.php** file in a text editor \n* Locate code where the $initArray variable is defined. Hint: it begins like this:    \n```\n    // TinyMCE init settings\n    $initArray = array (\n```\n* Now add the following line to the end of the array \n```\n    'extended_valid_elements' =\u003e 'style\n```\n* Don't forget to add a comma to the end of the preceding line! (in this example thats the one ending in \"$plugins\")\n\nIf all goes to plan the lower half of the $initArray declaration should look like this: \n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image34.png)\n\nAfter all that's done don’t forget to force your browser to flush its cache i.e. by using Control + F5.\n\nYou should now be able to use the style element in your posts, allowing you to create inline CSS to your hearts content.\n\nThe same principle applies if you want to allow any other html tags in WordPress.\n","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/auto-centering-canvas-wpf":{"title":"An Auto-Centering Canvas for WPF","content":"\n\nIf you try using WPF Canvas to plot objects in a 2d “scene”, you will hit a small problem. The Left and Top dependency properties dictate where the top left corner of your element is positioned. Not so good if you want to plot your elements at or over the coordinate position.\n  \nHere is a simple way to extend the Canvas such that Top and Left position your elements around their center.\n  \n        public class CenteringCanvas : Canvas\n        {\n            protected override Size ArrangeOverride(Size arrangeSize)\n            {\n                foreach (UIElement element in base.InternalChildren)\n                {\n                    if (element == null)\n                    {\n                        continue;\n                    }\n                    double x = 0.0;\n                    double y = 0.0;\n                    double left = GetLeft(element);\n                    if (!double.IsNaN(left))\n                    {\n                        x = left - element.DesiredSize.Width/2;\n                    }\n                    \n                    double top = GetTop(element);\n                    if (!double.IsNaN(top))\n                    {\n                        y = top - element.DesiredSize.Height/2;\n                    }\n                    \n                    element.Arrange(new Rect(new Point(x, y), element.DesiredSize));\n                }\n                return arrangeSize;\n            }\n        }\nOf course don't expect this code to work if you try setting the Right or Bottom properties.\n\n","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/code-generation-with-roslyn":{"title":"Code generation with Roslyn","content":"\nI recently wrote an answer on StackOverflow.com regarding what I've learned doing code generation with Roslyn.\n\nMy conclusion after a few weeks playing around is that using a combination of inline code snippets (parsed using `CSharpSyntaxTree.ParseText`) and manually generated `SyntaxNode`s, works well. But I felt a strong preference for the former. I have also used T4 in the past but am moving away from them due to general lack of integration \u0026amp; capability. I compare the three approaches below and conclude with some tips about doing code gen with Roslyn:\n\n## Advantages/disadvantages of each:\n\n### Roslyn ParseText\n\n* Generates arguably more readable code-generator code.\n* Allows 'text templating' approach e.g. using C# 6 string interpolation.\n* Less verbose.\n* Guarantees valid syntax trees.\n* Can be [more performant](http://comealive.io/Syntax-Factory-Vs-Parse-Text/).\n* Easier to get started.\n* Text can become harder to read than `SyntaxNodes` if majority is procedural.\n\n### Roslyn SyntaxNode building\n\n* Better for transforming existing syntax trees - no need to start from scratch.\n    * But existing trivia can make this confusing/complex.\n* More verbose. Arguably harder to read and build.\n    * Syntax trees are often more complex than you imagine\n* `SyntaxFactory` API provides guidance on valid syntax.\n* [Roslyn Quoter](http://roslynquoter.azurewebsites.net/) helps you transform textual code to factory code.\n* Syntax trees are not necessarily valid.\n* Code is perhaps more robust once written.\n\n## T4 templates\n\t\n* Good if majority of code to be generated is boiler plate.\n* No proper CI support.\n* No syntax highlighting or intellisense without 3rd party extensions.\n* One to one mapping between input and output files.\n    * Not ideal if you are doing more complex generation e.g. entire class hierarchy based on single input.\n* Still probably want to use Roslyn to \"reflect\" on input types, otherwise you will get into trouble with System.Reflection and file locks etc.\n* Less discoverable API. T4 includes, parameters etc. can be confusing to learn.\n\n## Roslyn code-gen tips\n\t\n* If you are only parsing snippets of code e.g. method statements, then you will need to use `CSharpParseOptions.Default.WithKind(SourceCodeKind.Script)` to get the right syntax nodes back.\n* If you are parsing a whole block of code for a method body then you will want to parse it as a `GlobalStatementSyntax ` and then access the `Statement` property as a `BlockSyntax`.\n* Use a helper method to parse single `SyntaxNode`s:\n```csharp\nprivate static TSyntax ParseText\u003cTSyntax\u003e(string code, bool asScript = false)\n{\n    var options = asScript\n        ? CSharpParseOptions.Default.WithKind(SourceCodeKind.Script)\n        : CSharpParseOptions.Default;\n\n    var syntaxNodes =\n        CSharpSyntaxTree.ParseText(code, options)\n            .GetRoot()\n            .ChildNodes();\n\n    return syntaxNodes.OfType\u003cTSyntax\u003e().First();\n}\n```\n* When building `SyntaxNode`s by hand you will typically want to make a final call to `SyntaxTree.NormalizeWhitespace(elasticTrivia: true)` to make the code \"round-trippable\".\n* Typically you will want to use `SyntaxNode.ToFullString()` to get the actual code text including trivia.\t\n* Use `SyntaxTree.WithFilePath()` as a convenient place to store the eventual file name for when you come to write out the code.\n* If your goal is to output source files, the end game is to end up with valid `CompilationUnitSyntax`s.\n* Don't forget to pretty-print using `Formatter.Format` as one of the final steps.\n\n","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/crash-vs2010-beta-2-help-mshelplistener-exe-has-stopped-working":{"title":"Crash when trying to open VS2010 Beta 2 Help: MSHelpListener.exe has stopped working","content":"\n**Update: There is a Microsoft Connect bug logged for this here**.\n\u003cspan style=\"color: #ff0000;\"\u003e\u003cstrong\u003eUpdate 2: \"R0b0tz\" has got the workaround for this on his \u003ca href=\"http://r0b0tz.com/?p=35\"\u003eblog\u003c/a\u003e. As always it pays to RTFM :)\u003c/strong\u003e\u003c/span\u003e\u003cspan style=\"color: #ff0000;\"\u003e\u003cstrong\u003e It's still definitely a bug though...\u003c/strong\u003e\u003c/span\u003e\n\nOne big change in Visual Studio 2010 is Microsoft Help version 3. It’s all based on HTML, and when you install the help locally it does a smart trick and installs its own web server (MSHelpListener.exe), allowing the pages to be accessed via the url [http://127.0.0.1:80/help](http://127.0.0.1:80/help).\n\nThe problem was the first time I ran the help after installing VS2010 I was getting the following crash…\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"MSHelpListener.exe has stopped working dialog\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image42.png\" border=\"0\" alt=\"MSHelpListener.exe has stopped working dialog\" width=\"536\" height=\"290\"\u003e\n\nIf you check the Windows Application event logs you will see the following error:\n\n**The port is already in use please select a different port**\n\n**** For some reason, MSHelpListener is unable to bind to port 80 (even though I believe HTTP.sys does allow multiple applications to bind to the same port).\n\nIf you go to the command line and run\n\n    netsh http show urlacl\nYou can see that it has also reserved the following url, although it appears this does not help at all in guaranteeing access to the port…\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"netsh showing urlacl reservation for MS Help 3\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image43.png\" border=\"0\" alt=\"netsh showing urlacl reservation for MS Help 3\" width=\"681\" height=\"166\"\u003e\n\nI had a quick look in Resource Monitor and this is what I saw:\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Resource Monitor showing Skype listening on port 80\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image44.png\" border=\"0\" alt=\"Resource Monitor showing Skype listening on port 80\" width=\"719\" height=\"501\"\u003e\n\nYou can see Skype was listening on port 80.\n\n**It turns out the solution was as simple as quitting Skype!**\n\nAfter I quit Skype I was able to load up the help…\n\n[](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image45.png)\n\nOnce HelpListener.exe is running it is safe to start Skype up again. I have yet to work out why Skype is using port 80, or what circumstances cause one process to block another’s use of a port, given the fact HTTP.sys is supposed to let multiple process share the same port. If you know please leave a comment.\n\nIf you find yourself having problems getting the local help working after installing it using “Find content on disk”, the trick that worked for me is to switch to online help and then back to local help.\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Help Library Manager screen in VS2010 Beta 2\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image46.png\" border=\"0\" alt=\"Help Library Manager screen in VS2010 Beta 2\" width=\"575\" height=\"392\"\u003e\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"MS Help 3 Find Content Online\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image47.png\" border=\"0\" alt=\"MS Help 3 Find Content Online\" width=\"575\" height=\"392\"\u003e\n\nOverall, MS Help v3 looks very nice and works as we probably wished it always had! What is very cool is you can “Find” content either online, or from your installation media. Best of all **it just works** – getting content from the web is straight forward, and so is installing it from media. Either way the help files can be kept up-to-date easily using “Check for updates online”. Nice","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":["vs2010"]},"/ddesigninstance-in-depth":{"title":"d:DesignInstance in Depth","content":"\n_Update: I have contacted WPF \"User education\" team at Microsoft about the lack of documentation. The response was:_ \n\n\u003e \"I've looked into this and there was some confusion around whether or not these were publicly exposed. Thanks for letting us know about this error **We are now working on getting these documented**.\"\n\nThere is currently no formal documentation for the `DesignInstanceExtension` (which you will see in XAML as `d:DesignInstance`).\n\nThe best two articles are by [Unni](http://blogs.msdn.com/unnir/archive/2009/07/12/introducing-sample-data-for-developers.aspx) and [Karl](http://karlshifflett.wordpress.com/2009/10/28/ddesigninstance-ddesigndata-in-visual-studio-2010-beta2/) but there are a few things they don’t cover.\n\nThis is what I have worked out by trial and error:\n\nAccording to Intellisense DesignInstance has got 3 parameters: `Type`, `IsDesignTimeCreatable` and `CreateList`.\n\n\u003ctable border=\"0\" cellspacing=\"0\" cellpadding=\"2\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003e\u003cstrong\u003eType\u003c/strong\u003e\u003c/td\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003eThis is the type of the object for which the design-time data binding “shape” will be derived\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003e\u003cstrong\u003eIsDesignTimeCreatable\u003c/strong\u003e\u003c/td\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003e(Defaults to false)\n\nIf this is \u003cstrong\u003etrue\u003c/strong\u003e then a new instance of your type will be created at designtime. If you want \u003cem\u003edata\u003c/em\u003e to actually appear in the designer you will need to make sure suitable properties are being set in your constructor. The best way to do this is to create a derived type of your model type, where you are free to set properties to default values without polluting your real types. If your model type implements an interface even better – you can create a design time model that way.\n\nIf this is \u003cstrong\u003efalse\u003c/strong\u003e VS/Blend will use reflection to create a dummy type with the same shape as your specified \u003cstrong\u003eType\u003c/strong\u003e. The problem with this is the dummy type will have no instance data in it thus you will not see anything in the designer. When this is \u003cstrong\u003efalse\u003c/strong\u003e you are really only getting the benefit of assisted type-aware data binding. (If you need lots of sample data you are better off using the \u003cstrong\u003eDesignData\u003c/strong\u003e extension)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003e\u003cstrong\u003eCreateList\u003c/strong\u003e\u003c/td\u003e\n\u003ctd width=\"400\" valign=\"top\"\u003e(Defaults to false)\n\nIf \u003cstrong\u003etrue\u003c/strong\u003e the \u003cstrong\u003eDesignInstance\u003c/strong\u003e will actually be created as a list of the specified \u003cstrong\u003eType\u003c/strong\u003e. From what I can tell this is the only way to specify your design instance as a collection (I briefly tried to pass a generic list as the \u003cstrong\u003eType\u003c/strong\u003e parameter but could not get it to work, hence why I expect this parameter exists).\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\nNote that DesignInstance and DesignData are mutually exclusive mark-up extensions. You cannot set both DesignInstance and DesignData extensions when setting your DataContext.\n\nIn general the main use of DesignInstance extension is to allow you to use the data binding tools within Blend and Visual Studio. It can give you some sample data if you set properties in your constructor.\n\nTo be able to design effectively you really need plentiful and varied sample data. For the best design experience you should consider using the DesignData extension – the drawbacks being the slightly increased upfront cost of creating a XAML file containing your sample data, and the increased complexity of refactoring the XAML whenever your classes change.","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/diagnosing-asp-net-page-compilation-errors":{"title":"Diagnosing ASP.NET page compilation errors","content":"\nPage compilation errors are a common cause of 'yellow screens of death' (YSOD) encountered by ASP.NET developers. During the heat of development it's very easy to ignore the details of these error messages, and instead resolve them with a bit of intuition. But there are limits to intuition. Today I had to drill into one of these errors and I learnt quite a bit along the way.\n\n## Are you missing an assembly reference?\n\nI'm going to tackle some of the most common page compilation errors, which relate to missing references and/or incorrect using statements. The screenshot below shows a typical 'CS0234' error:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/ysod-asp-net-namespaces-missing-references.png)\n\nThe compiler error message reads:\n\n\u003e The type or namespace name 'Helpers' does not exist in the namespace 'System.Web' (are you missing an assembly reference?).\n\n## Page compilation errors\n\nTo understand what is going on it's useful to have a quick reminder of how ASP.NET works under the hood.\n\nEvery page or view in an ASP.NET site ultimately gets converted into executable code. By default this happens at runtime.\n\nIt's a two-step process: Using a Razor view as an example, first the Razor view engine uses code generation to translate the .cshtml file into a .cs file. Then ASP.NET compiles that .cs source into an executable binary.\n\nIt's errors occuring during this second step which reveal themselves as YSODs like the one shown above. YSODs *do *actually include useful debug information...\n\n## YSOD examined\n\nClicking 'Show Complete Compilation Source' shows me the full C# source file which has been generated by the view engine for the requested page. Here you can clearly see all the using statements generated by the view engine code generator.\n\nClicking on 'Show Detailed Compiler Output' shows you exactly how csc.exe (the C# compiler) was invoked by ASP.NET in order to compile the page's generated C# code. Importantly the /R: parameters are the referenced assemblies.\n\nEvery C# developer knows that in order to succesfully build an assembly from a module of code you need to make sure all the types you use are made available to the compiler via references.\n\nWith normal C# projects you add your own references and write your own using statements. But what determines the references and using statements when code is generated for pages and compiled by ASP.NET?\n\n## References\n\nThe references used by ASP.NET during page compilation are specified entirely in configuration files using the [assemblies element for compilation](http://msdn.microsoft.com/en-us/library/vstudio/bfyb45k1(v=vs.100).aspx).\n\n*\"But I haven't specified an assemblies element!\"*, I hear you say.\n\nThe reason you still get some by default is that the **root-level** web.config file (typically found in `C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config`), that comes distributed with .NET, contains something akin to the following:\n\n        \u003ccompilation\u003e\n            \u003cassemblies\u003e\n                \u003cremove assembly=\"Microsoft.VisualStudio.Web.PageInspector.Loader, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"Microsoft.VisualStudio.Web.PageInspector.Loader, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"mscorlib\" /\u003e\n                \u003cadd assembly=\"Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Web.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System.EnterpriseServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" /\u003e\n                \u003cadd assembly=\"System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.ServiceModel.Activation, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.ServiceModel.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.Activities, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.ServiceModel.Activities, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.WorkflowServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" /\u003e\n                \u003cadd assembly=\"System.ComponentModel.DataAnnotations, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.Web.DynamicData, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"System.Web.ApplicationServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /\u003e\n                \u003cadd assembly=\"*\" /\u003e\n                ...\n            \u003c/assemblies\u003e\n        \u003c/compilation\u003e\n    \nUnless you make configuration changes this list will match the referenced assemblies you observe 'Show Detailed Compiler Output' section of the YSOD. Excluding one important exception...\n\nNote that the final entry is special. It uses a star '*' instead of providing an assembly name. The [remarks on MSDN](http://msdn.microsoft.com/en-us/library/vstudio/37e2zyhb(v=vs.100).aspx) explain it's purpose:\n\n\u003e Optionally, you can specify the asterisk (*) wildcard character to add every assembly within the private assembly cache for the application, which is located either in the \\bin subdirectory of an application or in the.NET Framework installation directory (%systemroot%\\Microsoft.NET\\Framework\\version).\n\nThe implications of this are that you can easily ensure additional assemblies get referenced during page compilation by placing them in your private assembly cache. And you do that simply by changing the \"Copy Local\" property of an assembly to true (correlated with the [Private](http://msdn.microsoft.com/en-us/library/bb629388.aspx) reference attribute within an MSBUILD file).\n\nBut what if you don't want to add the assembly to your private assembly cache? In that case you just explicity add it to your **application-level** web.config using the same `assemblies.add` element shown above.\n\n## Namespaces\n\nWhere do the default using statements come from for the generated code? Well this actually depends on the view engine you are using. The default view engine (Web Forms) takes its defaults from the **root-level** web.config under the [namespaces element](http://msdn.microsoft.com/en-us/library/vstudio/ms164642(v=vs.100).aspx):\n\n        \u003cpages\u003e\n            \u003cnamespaces\u003e\n                \u003cadd namespace=\"System\" /\u003e\n                \u003cadd namespace=\"System.Collections\" /\u003e\n                \u003cadd namespace=\"System.Collections.Generic\" /\u003e\n                \u003cadd namespace=\"System.Collections.Specialized\" /\u003e\n                \u003cadd namespace=\"System.ComponentModel.DataAnnotations\" /\u003e\n                \u003cadd namespace=\"System.Configuration\" /\u003e\n                \u003cadd namespace=\"System.Linq\" /\u003e\n                \u003cadd namespace=\"System.Text\" /\u003e\n                \u003cadd namespace=\"System.Text.RegularExpressions\" /\u003e\n                \u003cadd namespace=\"System.Web\" /\u003e\n                \u003cadd namespace=\"System.Web.Caching\" /\u003e\n                \u003cadd namespace=\"System.Web.DynamicData\" /\u003e\n                \u003cadd namespace=\"System.Web.SessionState\" /\u003e\n                \u003cadd namespace=\"System.Web.Security\" /\u003e\n                \u003cadd namespace=\"System.Web.Profile\" /\u003e\n                \u003cadd namespace=\"System.Web.UI\" /\u003e\n                \u003cadd namespace=\"System.Web.UI.WebControls\" /\u003e\n                \u003cadd namespace=\"System.Web.UI.WebControls.WebParts\" /\u003e\n                \u003cadd namespace=\"System.Web.UI.HtmlControls\" /\u003e\n                \u003cadd namespace=\"System.Xml.Linq\" /\u003e\n            \u003c/namespaces\u003e\n            ...\n        \u003c/page\u003e\n    \n\n## Namespaces with Razor\n\nIf you are using Razor the [default namespaces are hardcoded](http://stackoverflow.com/questions/14845541/where-are-the-default-razor-cshtml-namespaces-defined)!\n\nYou can easily *add* to the list of default namespaces by adding a razor-specific namespaces element to your `web.config` (sample shown below), but you cannot easily *remove* default namespaces. Even attempting to use `\u003cclear/\u003e` does not work. If you really need to get rid of default namespaces you will have to do it in code.\n\n    \u003csystem.web.webPages.razor\u003e\n      \u003chost factoryType=\"System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /\u003e\n      \u003cpages pageBaseType=\"System.Web.Mvc.WebViewPage\"\u003e\n       \u003cnamespaces\u003e\n        \u003cadd namespace=\"System.Web.Mvc\" /\u003e\n        \u003cadd namespace=\"System.Web.Mvc.Ajax\" /\u003e\n        \u003cadd namespace=\"System.Web.Mvc.Html\" /\u003e\n        \u003cadd namespace=\"System.Web.Optimization\"/\u003e\n        \u003cadd namespace=\"System.Web.Routing\" /\u003e\n       \u003c/namespaces\u003e\n      \u003c/pages\u003e\n    \u003c/system.web.webPages.razor\u003e\n    \n## A note about Web.configs\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/views-web-config.png)\n\nBare in mind that projects often have a web.config specifically for the Views folder (e.g. MVC) and the page compiler will pay attention to the config heirarchy. Typically you will want to makes changes specific to your Views `web.config`.\n\n## Conclusion\n\nUsing the information in this blog post you should be able to understand and resolve any page compilation errors relating to missing references and/or incorrect using statements. Good luck!","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/direct-download-links-for-sql-server-2008-express":{"title":"Direct Download Links for SQL Server 2008 Express","content":"\nI find it a bit annoying that Microsoft are pushing the Web Platform installer so hard these days that they have removed all obvious direct download links for the various SQL Express packages on the [\"Express\" site](http://www.microsoft.com/express/sql/). Not everyone has the luxury of unmetered downloads – some of us want to archive these installers locally, and not use the Web Platform Installer every time.\n\nTo save you the bother, here is my reimagining of the table on the [SQL Express downloads](http://www.microsoft.com/express/sql/download/) page:\n\n\u003c!--\n.sqltable { \twidth:620px; font-family:arial, sans-serif; \tfont-size:10px; height:auto; }\n.sqltable tr:hover td {background:black;}\n.sqltable tr { \tfont-family:arial, sans-serif; \tfont-size:10px; vertical-align:middle; \theight:60px; \theight:auto; }\n.sqltable td { \tpadding: 5px 5px 5px 5px; font-family:arial, sans-serif; font-size:10px; height:auto; background:black; text-align:center; color:white}\n.sqltable th { text-align:center; color:white;}\n.sqltable img { margin:0; border:0; padding:0;}\n.odd  { \tbackground-color:#171717; }\n.nobotborder  {}\n.nobotborder td { border-bottom-width:0 !important;\nborder-left:solid 1px #555555; border-right:solid 1px #555555; border-top:solid 1px #555555; border-bottom:solid 1px #555555; height:auto; }\n.botborder td { height:auto; border-bottom-width:1 !important; \tborder-top:solid 1px #555555; border-left:solid 1px #555555; border-right:solid 1px #555555; border-bottom:solid 1px #555555; }\n.nobotborderright  { border-right-width:0 !important; height:auto; }\n--\u003e\n\u003ctable class=\"sqltable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"\u003e\n\u003ctbody\u003e\n\u003ctr class=\"nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"font-size: 12px\"\u003e\u003cstrong\u003eServer 2008 Express\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"font-size: 12px\"\u003e\u003cstrong\u003eManagement Tools\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"font-size: 12px\"\u003e\u003cstrong\u003eRuntime\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"font-size: 12px\"\u003e\u003cstrong\u003eRuntime with Management Tools\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd\u003e\n\u003cp style=\"font-size: 12px\"\u003e\u003cstrong\u003eRuntime with Advanced Services\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"odd nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eSQL Server Management Database Engine\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #171717\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_gray.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_gray.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_gray.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eSQL Server Management Studio Express\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_black.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #000000\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_black.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_black.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"odd nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eFull-Text Search\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #171717\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #171717\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #171717\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_gray.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eReporting Services\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #000000\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #000000\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\n\u003cp style=\"color: #000000\"\u003e-\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd\u003e\u003cimg src=\"http://microsoft.com/express/images/checkmark_black.jpg\" border=\"0\" alt=\"Download Now\"\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eIncludes SP1\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eNo\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eYes\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eNo\u003c/td\u003e\n\u003ctd\u003eNo\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"odd nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eDownload Size\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003cspan style=\"text-decoration: line-through;\"\u003e38.5\u003c/span\u003e 168 MB\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e82.5 MB\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e230.4 MB\u003c/td\u003e\n\u003ctd\u003e546.5 MB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"nobotborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eCost\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eFREE\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eFREE\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003eFREE\u003c/td\u003e\n\u003ctd\u003eFREE\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"botborder\" align=\"center\"\u003e\n\u003ctd class=\"nobotborderright\"\u003eInstall\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003ca href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en\u0026amp;FamilyID=08e52ac2-1d62-45f6-9a4a-4b76a8564a2b\"\u003e\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Direct download button for SQL 2008 Management Tools\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/install_btn.jpg\" border=\"0\" alt=\"Direct download button for SQL 2008 Management Tools\" width=\"87\" height=\"44\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003ca href=\"http://www.microsoft.com/downloads/details.aspx?familyid=01AF61E6-2F63-4291-BCAD-FD500F6027FF\u0026amp;displaylang=en\"\u003e\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Direct download button for SQL 2008 Runtime\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/install_btn1.jpg\" border=\"0\" alt=\"Direct download button for SQL 2008 Runtime\" width=\"87\" height=\"44\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd class=\"nobotborderright\"\u003e\u003ca href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en\u0026amp;FamilyID=7522a683-4cb2-454e-b908-e805e9bd4e28\"\u003e\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Direct download button for SQL 2008 Runtime with Management Tools\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/install_btn2.jpg\" border=\"0\" alt=\"Direct download button for SQL 2008 Runtime with Management Tools\" width=\"87\" height=\"44\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en\u0026amp;FamilyID=b5d1b8c3-fda5-4508-b0d0-1311d670e336\"\u003e\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Direct download button for SQL 2008 Runtime with Advanced Services\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/install_btn4.jpg\" border=\"0\" alt=\"Direct download button for SQL 2008 Runtime with Advanced Services\" width=\"87\" height=\"44\"\u003e\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\nI am a bit confused how they came up with 38.5 MB for the SQL Management Studio download… if you check the direct download link you will see its 168 MB. This seems to tally up more closely with the combined “runtime with management tools” download of 230.4 MB. If they have managed to fit SSMSE into 38.5 MB then I am curious why I can’t find the direct download link - Leave a comment if you know the story behind that.\n\nI have one more comment about SQL Express, but it’s so important I’ve decided to write it as [separate blog post](http://jack.ukleja.com/sql-server-2008-express-with-advanced-services-does-not-include-service-pack-1-sp1/) in the hope it makes it easier for people/google to find. The post is about whether the various SQL Express downloads include Service Pack 1.","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/economics-of-microsoft-surface":{"title":"The Economics of Microsoft Surface","content":"\n\u003cspan style=\"color: #339966;\"\u003e\u003cspan style=\"color: #ff0000;\"\u003eThis is a post I wrote August 2009 but never got around to publishing. Whilst spring cleaning my drafts, I re-read it and decided it wasn't that bad, so here it is. I wonder if the issues are still the same in 2011....\u003c/span\u003e\u003c/span\u003e\n\n--------------------\n\nIt’s almost a year ago to the month that [Amnesia Razorfish smuggled the first Microsoft Surface tables into Australia](http://amnesiablog.wordpress.com/2008/08/19/unboxing-australias-first-microsoft-surface-table/) with the help of parent company Razorfish, much to the excitement of local geeks. There was also a fair bit of uproar from surprised parties who hadn’t expected to be usurped in such spectacular fashion.\n\nI was hired by Amnesia shortly before Surface arrived, partly on speculation that they would soon need a Surface developer. I had experience with the technologies it uses, and a great interest in the product, so was really excited to get such an opportunity. It was also a bit of a gamble on my part, as it was by no means guaranteed at the time they would even be getting a table, let alone any paying clients.\n\nThe first few weeks, maybe months, there was a great buzz and curiosity from clients and media about this new device. The phones were ringing off the hook and there were regular coffee table tours.\n\nDespite this, and the amazing stock of talent Amnesia had at its disposal, I think it’s safe to say that during my year there, they never needed more than this one, solitary, Surface developer.\n\nHow can that be? “Surely it would be as easy as selling antifreeze to Eskimos!”, I hear you mutter…\n\nHere’s why: In many scenarios, the economics of Surface development simply don’t add up.\n\nFor background, let’s put a few ballpark figures on the coffee table:\n\n- Cost of a MS Surface table: $10k\n- Cost of  development/design time: $200/hour\n\nLet’s tackle the most obvious thing first: **This Is Software Development.**\n\nIt’s been many years since the Adobe Flash experiences that draw crowds on the web have been built entirely with a visual tool. Most are chock full of ActionScript. In fact, dare I say, they probably contain more programming hours than design hours.\n\nSuffice to say there are very few digital experiences of the richness that people expect these days, that can be built without significant software development capabilities, and that goes for Microsoft Surface too.\n\nMicrosoft Surface carries the extra burden of not only having slightly less mature tools than industry mainstay Adobe Flash, but more importantly having a much smaller experience pool, particularly in the crucial “devigner” niche. And as with any new technology, the early days often mean higher costs and higher risks.\n\nSo, creating a quality Surface experience means building software. But what do you get for your money? Well it could easily cost you $6000 per man week, and even after many weeks development the chances are you won’t get that award winning experience you were hoping for. My guess is that most commercial Surface applications you see being touted cost in the region of $300,000. Definitely in the hundreds of thousands. Let your imagination go wild and you could easily spend half a million.\n\nThe next most obvious thing is: **Penetration**.\n\nUnlike building a user experience for the web, prospective clients will be footing the bill for each and every device that will end up in front of users. If you are going to pay a hefty sum for bespoke software development you sure as hell want to leverage that investment by deploying it to the maximum number of locations.\n\nYou can keep the costs low by only having a tiny number of tables (and maybe even spin that to your boss by claiming the experience would then be *truly unique/exclusive!*), but ultimately you are talking about investing in a piece of custom-written software that will only ever be seen by a tiny audience. Yes, that might be tenable for a small number of luxury brands, but for the majority who actually need to justify there expenditure? I think not.\n\nSo, to get “good value” from your investment in a Surface experience you need to also purchase a reasonably large number of tables. I would say at least in the tens if not hundreds (e.g. retail locations). There’s $500,000 right there.\n\nLastly: **Cost/benefit**.\n\nAt the end of the day, clients have to estimate how much a Surface experience is going to be worth to them. It’s obvious that many applications of Surface can be categorized as marketing in some sense; whether its experiential branding, attractive gimmick, or 9 o’clock news hype.\n\nI can only imagine it’s *very hard* to estimate the financial benefits such a Surface experience will bring, because in the majority of cases it’s going to be an indirect effect at best. And such financial benefits are almost certainly going to be impossible to determine a-priori.\n\nWhich is also the case if Surface is used as Point-of-Sale platform – it’s all pretty much undiscovered country. With such little data on natural user interfaces, not to mention Surface specifically, it’s very hard at this stage to make confident guesses about how conversion rates or stickiness can be improved. The only way to find out for sure is by putting down the cash. And that’s a risk many firms can’t or wont take.","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/expression-blend-3-help-the-missing-delegatecommand-class":{"title":"Expression Blend 3 Help: The missing DelegateCommand class","content":"\n\nSome tutorials from the Expression Blend 3 help docs (e.g. **“Try it: Display data from a sample SQL database”,** which is based on these [two](http://msdn.microsoft.com/en-us/library/cc294789.aspx) [articles](http://blogs.msdn.com/expression/articles/528008.aspx)**)** require a class that is present in the ColorSwatch WPF sample. The problem is that someone appears to have forgotten to bundle the ColorSwatch sample with the Blend 3!\n  \nTo save you the hassle of trying to track down the DelegateCommand class here it is:\n  \n    using System; \n    using System.Collections.Generic; \n    using System.Text; \n    using System.Windows.Input; \n     \n    namespace ColorSwatch \n    { \n        public sealed class DelegateCommand : ICommand \n        { \n            public delegate void SimpleEventHandler(); \n     \n            private SimpleEventHandler handler; \n     \n            private bool isEnabled = true; \n     \n            public DelegateCommand(SimpleEventHandler handler) \n            { \n                this.handler = handler; \n            } \n     \n            #region ICommand implementation \n     \n            void ICommand.Execute(object arg) \n            { \n                this.handler(); \n            } \n     \n            bool ICommand.CanExecute(object arg) \n            { \n                return this.IsEnabled; \n            } \n     \n            public event EventHandler CanExecuteChanged; \n     \n            #endregion \n     \n            public bool IsEnabled \n            { \n                get { return this.isEnabled; } \n                set \n                { \n                    this.isEnabled = value; \n                    this.OnCanExecuteChanged(); \n                } \n            } \n     \n            private void OnCanExecuteChanged() \n            { \n                if (this.CanExecuteChanged != null) \n                { \n                    this.CanExecuteChanged(this, EventArgs.Empty); \n                } \n            } \n        } \n    } ","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/fix-for-windows-7-random-wake-from-sleep-problem":{"title":"Fix for Windows 7 \"random wake from sleep\" problem","content":"\nFor the last few months I've had Windows 7 RC installed on two home computers, and both of them have exhibited a strange problem: They would randomly wake from sleep .\n\nThe computers would often wake up just seconds after being shut down. At other times they would wake up in the middle of the night. To make matters worse one PC, which had recently had its graphics card upgraded, would go into an endless loop of restarting without ever getting to the Windows login screen. I suspected a power problem relating to the new card.\n\nI spent quite some time investigating these wake problems (which I believed were unrelated) but could not diagnose the issue. Eventually I gave up and had to disable sleep on both machines (which pained me greatly!).\n\n[ad#Google Adsense #1]\n\nLast week I had a second wind and was determined to resolve this problem once and for all. I figured there must be a tool that could tell me what caused the wake up events, and after some research I discovered the Vista/Windows 7 [powercfg](http://technet.microsoft.com/en-us/library/cc748940(WS.10).aspx) tool.\n\nTo use this tool you simply type **powercfg –lastwake** at the command prompt\n\n\u003cimg style=\"display: inline; border: 0px initial initial;\" title=\"powercfg with lastwake command\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/powercfg1.png\" border=\"0\" alt=\"powercfg\" width=\"681\" height=\"226\"\u003e\n\nIn the above screenshot you can see the computer was woken by something on the USB hub (my mouse in this case). But much to my annoyance, when I ran this tool after a phantom wake it reported the type was “Unknown”!\n\nBecause I had a suspicion this could be a wake-on-lan (WOL) behaviour I used the [WireShark](http://www.wireshark.org/) network analysis tool to monitor network traffic for WOL packets. Perhaps a third computer had been infected with malware and was trying to wake other computers to have its wicked way? Unfortunately nothing showed up on the wire.\n\nNo further progress was made until I randomly stumbled across a forum posting about a network adaptor setting called \"**Wake on pattern match**\". I checked both my PCs and this setting \u003cspan style=\"text-decoration: underline;\"\u003ewas\u003c/span\u003e enabled. It appears this obscure setting is **enabled by default in Windows 7** for Realtek RTL8168B/8111B and RTL8168C(P)/8111C(P) Family Gigabit Ethernet NICs**.**\n\nWhat does \"Wake on pattern match\" actually do?\n\n[ad#Google Adsense #1]\n\nMost people are familiar with Wake-on-LAN which uses a \"magic packet\" (hard-coded) to trigger a wake event. Well it seems that feature has been superseded by the more flexible \"Wake on pattern match\" capability. According to this [Microsoft Article on Power Management for Network Devices](http://www.microsoft.com/whdc/archive/netpm.mspx):\n\u003cblockquote\u003eThe packet patterns that define the wake-up frames [for \"wake on pattern match\"] are provided to the NDIS 5.0 miniport driver by the operating system. At runtime, the protocol sets the wake-up policy using OIDs. These are, for example, \u003cem\u003eEnable Wakeup\u003c/em\u003e\u003cem\u003eSet Packet Pattern\u003c/em\u003e\u003cem\u003eRemove Packet Pattern\u003c/em\u003e. Currently, the Microsoft TCP/IP is the only Microsoft protocol stack that supports network power management. \u003cstrong\u003eIt will register the following packet patterns at miniport initialization\u003c/strong\u003e:\n\u003cul\u003e\n\t\u003cli\u003eDirected Layer Two packet\u003c/li\u003e\n\t\u003cli\u003eAddress resolution protocol (ARP) broadcast for station IP address (frames with DIX header)\u003c/li\u003e\n\t\u003cli\u003eNetBIOS over TCP/IP broadcast for station's assigned \u003cem\u003ecomputername\u003c/em\u003e (frames with DIX header)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\nI am no networking expert but the last two sound like they could be pretty common activities on your typical home network. If so it's no wonder my computers were exhibiting such crazy wakeup symptoms. (Either that or I have got a renegade PC on my networking sending out these packets).\n\nThe solution? Simply disable the \"Wake on pattern match\" setting under the network adaptors advanced properties tab, as shown below:\n\n[](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/realtek_wake_on_pattern_match.png)\n\nMy biggest mistake? I could have short circuited the resolution of this problem by testing my computers without the Ethernet cable plugged in right at the start. The reason I didn't was I couldn't understand how a WOL packet could possibly be being sent so I ignored the possibility.\n\nNow I know about \"Wake on pattern match\", next time I will be prepared.\n\n[ad#Google Adsense #1]","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":[]},"/how-to-get-ericsson-f3507g-mobile-broadband-card-working-on-windows-7-lenovo-thinkpad-t400s":{"title":"How to get Ericsson F3507g Mobile Broadband card working on Windows 7 \u0026 Lenovo Thinkpad T400s","content":"\n\u003cspan style=\"color: #ff0000;\"\u003e\u003cstrong\u003eUpdate: A new driver has been released which uses the Windows 7 Mobile Broadband driver framework. Please \u003ca href=\"http://jack.ukleja.com/update-ericsson-f3507g-mobile-broadband-on-windows-7-with-lenovo-thinkpad/\"\u003esee my new article\u003c/a\u003e. Note: Information and comments on this article could still be relevant to you so read on...\u003c/strong\u003e\u003c/span\u003e\n\nI recently purchased a [Lenovo Thinkpad T400s](http://shop.lenovo.com/us/notebooks/thinkpad/t-series/t400s). I installed Windows 7 on it soon after, having heard that almost all hardware devices worked under Windows 7. For me it was crucial that the Ericsson F3507G internal mobile broadband card worked, and luckily there was a driver for it available on [Lenovo’s Windows 7 “Beta” drivers](http://www-307.ibm.com/pc/support/site.wss/document.do?sitestyle=lenovo\u0026amp;lndocid=WIN7-BETA#f3507g)…\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"God knows what a \u0026quot;Drever\u0026quot; is!\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image20.png\" border=\"0\" alt=\"God knows what a \u0026quot;Drever\u0026quot; is!\" width=\"456\" height=\"265\"\u003e\n\nFirst thing to note is that even though it says “32-bit”, inside the zip there are actually 64-bit drivers as well. Phew! Unfortunately it seems that versions and publish dates are not supported by Lenovo’s knowledge base, so all we get is a crazy looking file name – 7uwc46ww.zip.\n\nAfter you install this driver you will have several new devices available in Device Manager:\n\n\n\t\n* Ericsson F3507g Mobile Broadband Minicard Network Adapter\n\t\n* Ericsson F3507g Mobile Broadband Minicard Modem\n\t\n* Ericsson F3507g Mobile Broadband Minicard Device Management (COM3)\n\t\n* Ericsson F3507g Mobile Broadband Minicard GPS Port (COM6)\n\t\n* Ericsson F3507g Mobile Broadband Minicard PC SC Port\n\t\n* Ericsson F3507g Mobile Broadband Minicard Composite Device\n\n\n[ad#Google Adsense #1]\n\nI am not a big fan of using OEM software over what comes with Windows, as it’s invariably crap. Lenovos’s network manager tool is called [Access Connections](http://lenovoblogs.com/insidethebox/?p=270) and I would later discover my intuition would prove  to be well founded.\n\nSo at this point I decided to try using the device as a dial up modem, by using “Create a Dial-up Connection”, then picking one of the two modems that show up (never worked out what the difference was).\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Create a Dial-up Connection dialog\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image21.png\" border=\"0\" alt=\"Create a Dial-up Connection dialog\" width=\"632\" height=\"464\"\u003e\n\nThe problem is it will then ask you for a Dial-up phone number, and various other fields wholly inappropriate for a 3G WWAN card. After a bit of googling I worked out that you should use *99***1# in the phone number field (*99# may also “work”), and leave the user name and password fields blank.\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Create a Dial-up Connection details\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image22.png\" border=\"0\" alt=\"Create a Dial-up Connection details\" width=\"632\" height=\"464\"\u003e\n\nThe problem was after connecting I would get “Error 734: The PPP link control protocol was terminated”\n\n\u003cimg style=\"border: 0pt none; display: inline;\" title=\"Error 734: The PPP Link control protocol was terminated\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image_thumb13.png\" border=\"0\" alt=\"Error 734: The PPP Link control protocol was terminated\" width=\"443\" height=\"438\"\u003e\n\nNow there was a setting I definitely knew I needed to put in somewhere, because all 3G modems require an APN… but there is no self-evident place to put this setting (remember basically we are trying to use a piece of 2009 technology with a modem interface designed probably 30 or 40 years ago!). After a bit of hunting around it turns out that you can put this setting in the “Extra Initialization commands”. Not the easiest thing to find but its located in Phone and Modem –\u0026gt; Properties –\u0026gt;Advanced dialog.\n\nThe string to set the APN is some variant of\n\n\n    AT+CGDCONT=1,”IP”,”dodolns1”\n\nwhere dodolns1 is your broadband provider’s APN.\n\nEven after figuring this out I would still get the Error 734 message! Bah!\n\n## Lenovo Access Connections = No Good\n\nAt this point I gave up and decided to try using the Beta version of Access Connections. I downloaded the “[6jc718us.zip](http://www-307.ibm.com/pc/support/site.wss/license.do?filename=thinkvantage_en/6jc718us.zip)” version. I installed it and it worked.\n\nKind of.\n\nNow I am all for OEM’s giving early access to software, but unfortunately Access Connections is no where near “Beta” standard. “Beta” in this case just seems to just be a label for lazy and poorly tested code. There are at least 3 huge bugs with Access Connections for Windows 7:\n\n\n\t\n* A memory leak that causes explorer.exe to consume 900MB of RAM every 20 hours or so. At which point explorer would stop working, and I would have to kill and restart it. For a bug as huge as that to be released into the public, no matter what label you give it, is a sign of a rotten development process.\n\t\n* It constantly forgets your customised APN settings. So each time I wanted to connect I would have to delve into the settings and enter them again.\n\t\n* The WWAN connection it created for me was generally unreliably and would drop IP connectivity every 5-30 minutes (the wireless/PHY link would be fine, just the IP stack would stop working).\n\t\n* It could, and often would, take ages to connect.\n\t\n* Performance was pretty sluggish – it would take ages to load the main interface. All I want is for my broadband card to work!\n\n\nI lived with this situation for a few weeks, but today I couldn’t handle it any more. I uninstalled Access Connections and will probably never use it again. As I said OEM software is invariably crap and this “Beta” was no exception.\n\n[ad#Google Adsense #1]\n\n\n## The Solution – Sony Ericsson Wireless Manager\n\nI have to credit some [posters on Thinkpads Forum](http://forum.thinkpads.com/viewtopic.php?f=18\u0026amp;t=74021) for the final, and only, solution I was happy with.\n\nBasically you just have to download a tentatively related piece of software from Sony Ericsson, called “Wireless Manager” which they claim is for an apparently unrelated card, the EC400g.\n\n[http://www.sonyericsson.com/cws/support/mobilebroadband/download/wirelessmanager/ec400?lc=en\u0026amp;cc=gb](http://www.sonyericsson.com/cws/support/mobilebroadband/download/wirelessmanager/ec400?lc=en\u0026amp;cc=gb)\n[http://www.sonyericsson.com/cws/support/mobilebroadband/download/wirelessmanager/ec400g?lc=en\u0026amp;cc=gb](http://www.sonyericsson.com/cws/support/mobilebroadband/download/wirelessmanager/ec400g?lc=en\u0026amp;cc=gb)\n\nBoth links get you to the same software. Nowhere does it mention that the F3507g card is supported, but I can confirm **it does work** using version 5.2.2056.12.\n\nThe filename I downloaded was **WirelessManager5.2.2056.12.zip**.\n\nAfter downloading and unzipping it, you just need to run “Sony Ericsson Wireless Manager 5.msi” which can be found inside the Install folder:\n\n\u003cimg style=\"border-width: 0px; display: inline;\" title=\"Showing the Wireless Manager installer\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image23.png\" border=\"0\" alt=\"Showing the Wireless Manager installer\" width=\"808\" height=\"437\"\u003e\n\nAfter that completes it will say something about “to install drivers, please click next”. Suffice to say that it just stops at this point and no drivers get installed. When you load it up you will be presented with this:\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Wireless Manager UI, with setting button highlighted\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image24.png\" border=\"0\" alt=\"Wireless Manager UI, with setting button highlighted\" width=\"420\" height=\"260\"\u003e\n\nThe first thing to do is click the spanner to setup your APN. (You may not have to do this – it depends on whether your provider is known in the standard list).\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Creating a new profile in Wireless Manager\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image25.png\" border=\"0\" alt=\"Creating a new profile in Wireless Manager\" width=\"764\" height=\"490\"\u003e\n\nFor my provider, [Dodo](http://www.dodo.com.au/), I had to untick the “Let Wireless Manager Choose the Connection Profile” and then I created a new profile, and put the Access Point Name (APN) in as shown above.\n\nYou then click “Enable Radio” and wait while it detects the mobile networks (hopefully including yours). If that is succesful you just press the big “Connect” button and you are online!\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Wireless Manager connecting\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image26.png\" border=\"0\" alt=\"Wireless Manager connecting\" width=\"420\" height=\"260\"\u003e\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Wireless manager connected\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image27.png\" border=\"0\" alt=\"Wireless manager connected\" width=\"420\" height=\"260\"\u003e\n\nOne great feature about this is that once the radio is enabled you have two ways of getting online. You can either use:\n\n\n\t\n* The Wireless Manager connect button which activates the Ericsson F3507g Mobile Broadband Network Adapter (which means you don’t have to mess about with any dial-up stuff)\n\t\n* Or you can use the RAS/Dial-up connection that Wireless Manager creates (It created one for me called WirelessManagerRasConnection).\n\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Network Connections showing Ericsson F3507g Mobile Broadband Network Adapter\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image28.png\" border=\"0\" alt=\"Network Connections showing Ericsson F3507g Mobile Broadband Network Adapter\" width=\"559\" height=\"338\"\u003e\n\nWhat is strange is that you can have both of them connected at the same time. I have yet to work out if that has a detrimental effect :-)\n\nOne final tip: If you look inside the “Show hidden icons” pane in the Windows taskbar, you will see the Wireless Manager. If you right click it and select “Hide to notification area” it will then remove the app from the task bar. Even better is if you then go into the “Customize” menu and change the behaviour to “Show icon and notifications” you will get this neat and handy icon for quick access to mobile broadband:\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Wireless Manager showing in icon tray\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image29.png\" border=\"0\" alt=\"Wireless Manager showing in icon tray\" width=\"237\" height=\"195\"\u003e\n\nAnyway, let me know how you go, and if I missed anything in my instructions.\n\n[ad#Google Adsense #1]\n","lastmodified":"2023-07-22T09:12:47.223133951Z","tags":["ericsson","lenovo"]},"/how-to-make-a-bootable-vista-dvd-using-mkisofs-cdrtools":{"title":"How to make a bootable Vista DVD using MKISOFS/CDRTOOLS","content":"\n\n*UPDATE: This is a repost of an old article that is still referenced on some forums.*\n  \nI managed to get hold of an MSDN copy of Vista on DVD. Unfortunately the DVD was corrupt and several of the sectors were unreadable. I managed to salvage all the files from the disc apart from a couple named license.rtf (no big loss there then!). The question was, how do I then make another bootable DVD from these salvaged files? No big deal you say - just create a bootable ISO like you did with Windows XP: [extract boot image](http://www.nu2.nu/bbie/) then use that to burn the files to a bootable DVD with Nero.\n  \nUnfortunately this wouldn't work because one of the files on the Vista DVD is \u0026gt; 2GB (install.wim) and the most common ISO modes (1 and 2) don't support files that big. Microsoft have a solution of course: There is a utility on the [Windows Automated Installation Kit (WAIK)](http://www.google.com.au/search?q=waik) called [Oscdimg](http://technet.microsoft.com/en-us/library/cc749036%28WS.10%29.aspx)**** which is designed to make ISO images from Vista trees. Perfect, the download is [here](http://download.microsoft.com/download/8/6/d/86d6ba9c-98ff-444e-87ed-3e76772eb2a6/vista_6000.16386.061101-2205-LRMAIK_EN.img). Unfortunately its 900MB and I'll be damned if im gonna download all that just for a 50k utility! So I decided to try using makeisofs (from the [cdrtools](http://cdrecord.berlios.de/private/cdrecord.html) package. N.B. for windows you will need to download a [windows binary](http://smithii.com/cdrtools)). After 20 minutes of fiddling around I got the following to work: \n  \n    mkisofs -udf -v -b boot.bin -no-emul-boot -hide boot.bin -hide boot.catalog -o MyVistaIso.iso Vista\nWhere *boot.bin* is the name of the boot sector extracted from the orignal corrupt DVD, and *Vista* is the name of the directory containing the salvaged contents of the original DVD. Note: The *boot.bin* file must be within the *Vista* directory for mkisofs to find it. Anyway, I burned the iso to a DVD, restarted my PC, and it booted into the Vista installer. I proceeded to install Vista and everything worked fine. Yay! \n\n","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":["vista"]},"/microsoft-expression-web-3-ui-built-with-wpf-expression-studio-moves-forward":{"title":"Microsoft Expression Web 3 UI Built With WPF; Expression Studio Moves Forward","content":"\n\nA few months ago [I asked a question on Somasegar’s blog](http://blogs.msdn.com/somasegar/archive/2009/06/05/expression-web-3.aspx) about the new Expression Web 3, specifically whether the UI would be getting updated to match the rest of the Expression suite.\n  \nHaving downloaded Expression Web 3 this afternoon I can safely say one thing: **Expression Web 3 definitely uses WPF**. The screenshot below was taken using [Snoop](http://blois.us/Snoop/), a utility that lets you do 3D exploded views, and shows all the layers in the Expression Web UI.\n  \n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Expression Web is built with WPF\" border=\"0\" alt=\"Expression Web is built with WPF\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/expression_web_3_exploded2_thumb.jpg\" width=\"644\" height=\"463\"\u003e\n  \nThis does not confirm whether Expression Web is using the same UI framework as Expression Blend, in the sense that a similar look and feel *could* be achieved independently, i.e. without the two teams working from a shared UI code base. It’s hard to pick out any UI elements that are definitively shared with Blend, except perhaps the tool windows. Without delving into the code, it’s my guess we are seeing the first steps of merging the UIs (perhaps some shared styles) but we do not have a unified code base yet. Another thing which is obvious: the finesse of Blend is certainly not yet present in Web – just witness the number of retro-fitted Win32-esque dialogs:\n  \n\u0026#160;\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"One of many fugly dialogs. Yes this is real!\" border=\"0\" alt=\"One of many fugly dialogs. Yes this is real!\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image31.png\" width=\"477\" height=\"384\"\u003e \n  \n## So what?\n  \nTo explain why I am so interested in Expression Web’s UI we have to delve into the background of Expression…\n  \nIt’s no secret that Expression Studio was never written from the ground up as suite of closely integrated tools. It was basically pulled together out of thin air when some marketing guy at Microsoft noticed they had a collection of upcoming software packages that could fall under a single “creative” banner. That banner was Expression.\n  \nOK, that’s the cynical explanation. :) Microsoft had a very good strategic reason to create a new design suite...\n  \nMicrosoft had early realised the importance of having a large developer community. In fact today, the software ecosystem built around Windows is pretty much the cornerstone of Microsoft’s business. \n  \n\u003cimg style=\"border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px\" title=\"Expression Studio 3 box\" border=\"0\" alt=\"Expression Studio 3 box\" align=\"left\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/US_Prd_Bx_Tilt_L_Expression_Studio_3_thumb.png\" width=\"202\" height=\"239\"\u003e \n  \nBut as time passed expectations of how software should look \u0026amp; feel began to sky rocket. With software, as with most things in life, **sex sells** – just look at Apple’s resurgence for proof of that. Software had finally become less about features, and more about usability, enjoyment and style (users want to experience “Delight” as [Shane Morris](http://blogs.msdn.com/shanemo/) likes to put it).\n  \nThe problem is, the people with the skills to improve UX – well, basically they live and breath Adobe. While Microsoft owns massive developer mindshare it owns very little designer mindshare – **both** ingredients are required to build compelling applications these days. Microsoft needs to capture designer mindshare and get them comfortable using Expression suite.\n  \n## Practice what you preach\n  \nThe problem is: if your design tool looks/feels like a turd (e.g. Web 2), why is any designer going to take you seriously? And if a designer doesn’t take you seriously how will you gain designer mindshare? And without designer mindshare how can Microsoft win the UX battle?\n  \n**They can’t.** That’s why when you looked at previous versions of Expression suite there was definitely a bad smell left by the inconsistent UIs. This may be subtle to some people but it’s what UX is all about – you might have a a good software product, but if your supposed suite of applications clearly don’t share the same UI framework (or dialogs boxes look like they were lifted straight out of Windows 95!) you are going to be judged and punished by the market.\n  \nThat’s why its good to see Expression Web move to WPF – it was the biggest eye sore in the suite. I should add that I am a very big fan of majority of Expression, in particular Blend’s UI. It’s just that when you are selling a tool for designers/creative's you better make sure you practice what you preach because you will be judged *very harshly*. Considering the pressure that is on the Expression teams (again a big shout out to the amazing job done by [Unni](http://blogs.msdn.com/unnir/), [Lutz Roeder](http://blog.lutzroeder.com/) etc on Blend) and the standards they have to live up to they have done reasonably well. Unfortunately in this market segment they simply cannot rest :)\n  \n## Step in the right direction\n  \nFor end-users, the eventual unification of Expression Studio into a single, compelling UI framework will do wonders for the Expression UX, increasing user productivity and hopefully growing Microsoft’s designer mindshare. For Microsoft it will allow them to develop the Expression suite more efficiently, meaning higher quality, more frequently released applications. It will also continue to demonstrate that Microsoft are serious about using their own technologies and that WPF is a viable.\n  \nAs a random aside, I am hopeful that one day Microsoft decide to take Expression a step further, growing the suite to include a Photoshop- or Fireworks-like tool, and thus create some genuine competition in the moribund designer tool market; perhaps even break Adobes dominant position it has abused for so long (see prices they charge!). Whether you like Microsoft or not there is no doubt that competition in the creative suite market benefits us all.\n","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/microsoft-surface-development-goes-public":{"title":"Microsoft Surface development goes public","content":"\n\nAt PDC this year Microsoft announced that Surface development resources were going to be made publicly available. (Up until now it had been an “invitation only” system).\n  \nThis is great news and means anyone can build or prototype Surface applications. The Surface SDK comes with a very good simulator. A table is still needed to evaluate performance and usability, but you can go a long way with just the simulator.\n  \n[](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image48.png) \n  \nHere is a copy \u0026amp; paste from a recent mail-out:\n  \u003cblockquote\u003e   \u003cli\u003eSurface Web site (http://www.surface.com)      \u003cul\u003e       \u003cli\u003eA new \u003cstrong\u003e\u003ca href=\"http://www.microsoft.com/surface/Pages/Technical/Learn.aspx\"\u003eTechnical Resources section\u003c/a\u003e \u003c/strong\u003eto help you connect to the other available resources and support. \u003c/li\u003e     \u003c/ul\u003e   \u003c/li\u003e    \u003cli\u003eMSDN (http://msdn.microsoft.com)      \u003cul\u003e       \u003cli\u003eA new \u003cstrong\u003e\u003ca href=\"http://msdn.microsoft.com/en-us/library/ee804845.aspx\"\u003eMicrosoft Surface section of the MSDN Library\u003c/a\u003e\u003c/strong\u003e (under .NET Development), providing the Surface SDK documentation and other topics about developing Surface applications. \u003c/li\u003e        \u003cli\u003eNew \u003cstrong\u003e\u003ca href=\"http://go.microsoft.com/fwlink/?LinkID=169175\"\u003eSurface-specific forums\u003c/a\u003e\u003c/strong\u003e about designing and developing Surface applications. \u003c/li\u003e     \u003c/ul\u003e   \u003c/li\u003e    \u003cli\u003eTechNet (http://technet.microsoft.com)      \u003cul\u003e       \u003cli\u003eA new \u003cstrong\u003e\u003ca href=\"http://technet.microsoft.com/en-us/library/ee692162.aspx\"\u003eMicrosoft Surface section of the TechNet Library\u003c/a\u003e\u003c/strong\u003e (under Products and Technologies), describing the basics of the Surface software and hardware and how to set up, customize, troubleshoot, and maintain Surface units. \u003c/li\u003e        \u003cli\u003eNew \u003cstrong\u003e\u003ca href=\"http://go.microsoft.com/fwlink/?LinkID=169176\"\u003eSurface-specific forums\u003c/a\u003e\u003c/strong\u003e about the Surface software platform, hardware, and applications. \u003c/li\u003e     \u003c/ul\u003e   \u003c/li\u003e    \u003cli\u003eMicrosoft Download center (http://www.microsoft.com/downloads)      \u003cul\u003e       \u003cli\u003eA new product category for \u003cstrong\u003e\u003ca href=\"http://www.microsoft.com/downloads/en/results.aspx?freetext=surface\u0026amp;displaylang=en\u0026amp;stype=s_basic\"\u003eall Surface downloads\u003c/a\u003e\u003c/strong\u003e, including the Surface SDK Workstation Edition, applications, documentation, and any software fixes. \u003c/li\u003e     \u003c/ul\u003e   \u003c/li\u003e    \u003cli\u003eMicrosoft Support (http://support.microsoft.com)      \u003cul\u003e       \u003cli\u003e\u003cstrong\u003e\u003ca href=\"http://go.microsoft.com/fwlink/?LinkID=177396\"\u003ePublic Surface KB articles\u003c/a\u003e\u003c/strong\u003e for fixes, known issues, and workarounds. \u003c/li\u003e        \u003cli\u003e\u003ca href=\"http://go.microsoft.com/fwlink/?LinkID=177395\"\u003e\u003cstrong\u003eSurface Solution Center\u003c/strong\u003e\u003c/a\u003e to direct customers to the right self-support and assisted-support options. \u003c/li\u003e     \u003c/ul\u003e      \u003cp\u003e   \u003c/li\u003e\u003c/blockquote\u003e","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/nursing-diagnosis-is-not-software-engineering-amazons-crazy-book-categorization":{"title":"Nursing Diagnosis is NOT Software Engineering: Amazon’s crazy book categorization","content":"\n\nI’ve actually noticed this for a few years, but there is something **crazy** going on with how [Amazon.com](http://amazon.com) categorizes its Computer Science/Software books.\n  \nOne of my favourite ways to find new books is to use the “wisdom of the crowds” and browse through Amazon’s bestseller lists. If I find a book I like I always check the bestsellers in it’s categories in the hope that I can find some other gems.\n  \nThe problem is I always end up getting frustrated because there is so much garbage in the lists: I would say *at least* 40% of the books are miscategorized. \n  \nIs this some sort of ruse by publishers to get their books featured in more places? If so its bloody annoying and doesn’t do anyone any favours.\n  \nLet me show you the [bestsellers for the Software Engineering category](http://www.amazon.com/gp/bestsellers/books/280309/):\n  \n[](http://www.amazon.com/gp/bestsellers/books/280309/) \n  \n   \n* **The number one** bestseller is [The Adobe Photoshop CS4 Book for Digital Photographers](http://www.amazon.com/Adobe-Photoshop-Book-Digital-Photographers/dp/0321580095/ref=pd_ts_b_1?ie=UTF8\u0026amp;s=books). I’m sorry but last time I looked, learning Photoshop was NOT software engineering.    \n* **The number two** bestseller is even better… [Nursing Diagnosis Handbook: An Evidence-Based Guide to Planning Care](http://www.amazon.com/Nursing-Diagnosis-Handbook-Evidence-Based-Planning/dp/0323048269/ref=pd_ts_b_2?ie=UTF8\u0026amp;s=books). I am pretty sure that even a 10 year old child would not categorize nursing as Software Engineering.    \n* **The number three** bestseller is [slide:ology: The Art and Science of Creating Great Presentations](http://www.amazon.com/slide-ology-Science-Creating-Presentations/dp/0596522347/ref=pd_ts_b_3?ie=UTF8\u0026amp;s=books). Come on, somebody is just taking the piss now. \n  \n## How can we fix it?\n  \nInstead of just whining about it I spent 30 minutes going through the top 20 and using the feedback form to contact Amazon about the problem. As you can imagine this got boring quickly.\n  \nThen I figured the easier way might be just to go through and tag all the books as **miscategorized** (spelt with a ‘z’ to make it easier for our American friends) and **not software engineering**.\n  \nOne very handy tip is that you can tag Amazon books quickly just by pressing typing ‘TT’ on your keyboard. It bring up this window so you can instantly tag a product:\n  \n\u003cimg style=\"border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px\" title=\"Fast Tagging on Amazon.com\" border=\"0\" alt=\"Fast Tagging on Amazon.com\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/fast_tagging_amazon1.png\" width=\"525\" height=\"388\"\u003e \n  \nThe end result is something that looks like this:\n  \n\u003cimg style=\"border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px\" title=\"Miscategoized  Tags on Amazon.com\" border=\"0\" alt=\"Miscategoized  Tags on Amazon.com\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/miscategoized_tag_amazon1.png\" width=\"644\" height=\"185\"\u003e \n  \nIf enough people (i.e. YOU dear reader) tag these products, it should be pretty straight forward just to email amazon and say:\n  \u003cblockquote\u003e   \u003cp\u003eOi! Amazon!\u003c/p\u003e    \u003cp\u003ePlease find all your books tagged as \u003cstrong\u003emiscategorized\u003c/strong\u003e and fix them. In particular please remove all the books tagged \u003cstrong\u003enot software engineering\u003c/strong\u003e from the Software Engineering category.\u003c/p\u003e    \u003cp\u003eThanks!\u003c/p\u003e \u003c/blockquote\u003e  \n**So here's the call to action: Visit the** [bestsellers for the Software Engineering category](http://www.amazon.com/gp/bestsellers/books/280309/ref=pd_zg_hrsr_b_1_4)** and tag at least the top ten books!**\n","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/pathping-its-tracert-on-steroids":{"title":"Tip for pathping ","content":"\nThis lesser known command line utility, introduced on Windows 2000, is something of a hybrid between ping and tracert.\n\nInstead of just determining the path, pathping also sends a barrage of pings to each host along the route. After pathping completes (which can take 5 minutes) it generates statistics for failed pings at each node making it easy to indentify hosts in the route where packet loss is occurring. It also shows averaged round trip times (RTT) to each node, allowing you to identify slow hops, and visualize a packet's journey.\n\nIf you are anything like me though, you may never have paid close attention to pathping’s (somewhat confusing) output...\n\n\u003cimg style=\"border: 0pt none; display: inline;\" title=\"Image of pathping results with connecting bars highlighted\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image_thumb7.png\" border=\"0\" alt=\"image\" width=\"644\" height=\"374\"\u003e\n\nIf you look carefully (ok, not that carefully – I’ve circled the section in red) you will see the ASCII art bars “connecting” each host. What’s interesting is pathping shows you both the packet loss* between yourself and the host*, as well as packet loss on the links *between hosts* (the bars). As you can see in the screen shot above its perfectly possible to have a host (telstra310) that is not directly reachable, yet is perfectly able to forward on packets. There is an example in the the [full pathping documentation](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/pathping.mspx?mfr=true) that describes such a result like this:\n\u003cblockquote\u003eThe routers [snip] are dropping packets addressed to them, but this loss does not affect their ability to forward traffic that is not addressed to them.\u003c/blockquote\u003e\nOne thing I still haven’t figured out is what the value in the “This Node/Link” means in a row that has a “Source to Here” entry. I am assuming it means routed packets that entered the host but never left. Answers on a postcard.","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/sql-server-2008-express-with-advanced-services-does-not-include-service-pack-1-sp1":{"title":"SQL Server 2008 Express with Advanced Services does *NOT* include Service Pack 1 (SP1)","content":"\nThis is a very short post just to say that I spent 10 minutes trying to track down the answer to the question: **Does SQL Server 2008 Express with Advanced Services include Service Pack 1?**\n\nIt’s strange but I could find no blog posts that focused directly on this question, the official download page does not mention it, and I did not want to have to download every SQL Express distribution to find out.\n\nEventually I did find a post that revealed the answer, entitled “[Servicing SQL Server 2008 Express](http://blogs.msdn.com/petersad/archive/2009/02/25/servicing-sql-server-2008-express.aspx)”. Here is the key quote:\n\u003cblockquote\u003eStarting with SQL Server 2008, we won’t be shipping new packages of \"Express with Advanced Services\" or \"Express with Tools\" with Service Pack 1.  To update these editions, you will need to run the full \u003ca href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=en\u0026amp;FamilyID=66ab3dbb-bf3e-4f46-9559-ccc6a4f9dc19\"\u003eService Pack 1\u003c/a\u003e.\u003c/blockquote\u003e\nSo the answer is a pretty clear **No** – the SQL Server 2008 Express with Advanced Serviced/Tools packages **do not include service pack 1**. And by the way, the full service pack 1 mentioned in the quote is approx 300 MB.\n\nI have updated my [SQL Server 2008 Express direct download table](http://jack.ukleja.com/direct-download-links-for-sql-server-2008-express/) to include whether or not the download includes SP1. In summary only the “runtime” download includes SP1… the rest you will have to patch manually.\n\nDon’t know about you, but I’m mildly annoyed by that conclusion.","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/update-ericsson-f3507g-mobile-broadband-on-windows-7-with-lenovo-thinkpad":{"title":"Update: Ericsson F3507g Mobile Broadband on Windows 7 with Lenovo Thinkpad","content":"\nIt’s become clear from [comments on my previous article](http://jack.ukleja.com/how-to-get-ericsson-f3507g-mobile-broadband-card-working-on-windows-7-lenovo-thinkpad-t400s/), that Lenovo have released a new Windows 7 driver for the Ericsson F3507g Mobile Broadband card.\n\nYou would never know from glancing at the [downloads page](http://www-307.ibm.com/pc/support/site.wss/WIN7-BETA.html) because it doesn’t list versions numbers or publish dates...\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Screenshot of F3507g driver on Lenovo downloads page\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image36.png\" border=\"0\" alt=\"Screenshot of F3507g driver on Lenovo downloads page\" width=\"451\" height=\"243\"\u003e\n\nThe driver is now listed under **Vodafone and AT\u0026amp;T Wireless WAN (HSPA) Driver**. Just to make things extra confusing (and harder to find) they removed the actual card model number from the description. The new filename  is [7uw706ww.zip](http://download.lenovo.com/ibmdl/pub/pc/pccbbs/mobiles/7uw706ww.zip) (direct download link), and comes in at 40MB (10 MB smaller than the last driver). It comes as a Setup.exe, including both 32-bit and 64-bit drivers.\n\nAfter installing the new driver (no need to uninstall the previous one), you will have the following new devices in device manager:\n\n\n\t\n* F3507g Mobile Broadband Driver (Network Adapters)\n\t\n* F3507g Mobile Broadband Device Management (COM3)\n\t\n* F3507g Mobile Broadband GPS Port (COM6)\n\t\n* F3507g Mobile Broadband Device\n\n\nThe crucial thing about the new driver is the change in version from 4.4.50.6.0 (dated 16/12/2008) to 4.54.7103.1 (dated 26/06/2009). The drivers are also HCL certified by Microsoft. Some devices are dated 29/07/2009 and version 1.0.0.52. Either way, all the drivers are much newer :)\n\n[ad#Google Adsense #1]\n[](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image40.png)\n\nThis driver is radically different from the previous one. The previous driver installs your broadband card as an old school modem (with COM ports et al). This is what made it particularly tricky to setup.\n\nThe new driver actually gets the broadband card to show up as… (drum roll)... a **Mobile Broadband Connection!**\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Ericsson F3507G showing as Mobile Broadband  in Network Connections\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image37.png\" border=\"0\" alt=\"Ericsson F3507G showing as Mobile Broadband  in Network Connections\" width=\"578\" height=\"271\"\u003e\n\nThe upshot of this is that, **after installing these drivers you don’t need any third party software to get online!**\n\nI am not sure if this device type was available in Vista, but I have certainly never seen it before. It integrates with Windows differently to a dialup modem. One obvious change is that it shows up in the networks list accessed via the system tray like so:\n\n\u003cimg style=\"border: 0pt none; display: inline;\" title=\"Available connections\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image_thumb24.png\" border=\"0\" alt=\"Available connections\" width=\"174\" height=\"244\"\u003e\n\nYou can set it to automatically connect when there is no other connection available, which is quite handy and works quite well.\n\nThere is only one trick you may need for **setting the APN**. To do this you need to go to the networks list and right click, show properties. *Note: This is completely different than if you select properties in the Network Connections windows*. You should see the following:\n\n\u003cimg style=\"border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px\" title=\"Mobile Broadband connection properties under Windows 7, showing APN setting\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image39.png\" border=\"0\" alt=\"Mobile Broadband connection properties under Windows 7, showing APN setting\" width=\"393\" height=\"509\"\u003e\n\nHere you can enter the APN and username/password if required by your ISP.\n\nThere are only a couple of negatives I have discovered so far:\n\n\n\t\n* Using Wireless Manager it was possible to force the connection to only use HSDPA etc. I can’t find a way to do this with the new setup\n\t\n* There is not as much status information available as when using Wireless Manager. For instance, when I am connected, it ALWAYS seems to display UMTS as the connection type, even though I know I am on HSDPA. This may or may not be a bug.\n\n\nOne *very *exciting feature that I just stumbled upon when researching this article is the Windows 7 Sensor compatible GPS Location driver that gets installed.\n\n\u003cimg style=\"border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px\" title=\"F3507g GPS Location Sensor driver for Windows 7!\" src=\"https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image41.png\" border=\"0\" alt=\"F3507g GPS Location Sensor driver for Windows 7!\" width=\"644\" height=\"379\"\u003e\n\nThis new feature for Windows 7 allows applications to access your GPS data through a standard API, for example Google Chrome can use this to position you on Google maps! I have not got this to work so far but I am hoping that’s because I have no GPS signal indoors.\n\nOverall I am happy with the new drivers – it’s certainly a better way to integrate with Windows, and the connection seems to be much more reliable.\n\n[ad#Google Adsense #1]","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/using-a-telnet-client-as-a-port-scanner":{"title":"Using a telnet client as a port scanner","content":"\nIf you ever need to check if a TCP port is open or reachable, one easy way to do it is using a telnet client.\n\nA telnet client actually comes with Windows, but for some annoying reason it is not installed by default. To install the windows telnet client you need to add it using the “Turn Windows features on and off” like so:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image1.png)\n\nBecause Telnet is essentially just characters sent over a TCP connection, you can use the telnet client as a poor man’s TCP port scanner. To manually check if TCP port 80 is open or reachable on a server you can type **telnet myserver.com 80**.\n\nAs an example lets see if Google.com has port 80 (HTTP) open … ;-)\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image2.png)\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image3.png)\n\nIf you get a blank screen with a blinking cursor you have successfully connected to that TCP port.\n\nIn this example, if you are feeling particularly sadistic you can now engage in a HTTP conversation. Type **GET index.html HTTP/1.0** and press enter and you will see Google’s home page being sent to you. Same idea would apply if you connected to most other TCP-based protocols; POP mail server etc.\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image8.png)\n\nOn the other hand if the TCP port is not open or not reachable you will see this:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image4.png)\n\nTroubleshooting ports and firewalls can be a pain. This is the simplest and quickest way I know for checking connectivity.","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/using-ddesignsource-for-design-time-datagrid-grouping-with-sample-data":{"title":"Using d:DesignSource for design-time DataGrid grouping with sample data","content":"\n\nI recently had the need to use the row grouping feature of the WPF DataGrid. \n  \nAs you know, in order to design with Blend effectively, you really need to have data displayed at design-time. It’s fairly straight forward to use combinations of `d:DesignContext` and `d:DesignData` to achieve that goal. In the case of `DataGrid`, you can bind `ItemsSource` directly to a collection in your design-time model.\n  \nThe question is: How do you use design-time data and grouping at the same time?\n  \nThe reason the solution is not obvious is because the `DataGrid`’s grouping feature relies on having a `PropertyGroupDescription` configured for the `CollectionView` that the `DataGrid`'s `ItemSource` is bound to. If you bind `ItemsSource` directly to a collection, you do not have access to the `CollectionView` at design-time.\n  \nJust to confuse things, if you Google for [DataGrid grouping](http://www.google.com/search?q=datagrid+grouping) you will find a plethora of out-of-date articles suggesting you can configure the grouping by using the `DataGrid.GroupingDescriptions` in Xaml, which you can’t (it only worked on older/beta versions). On the other hand there are several articles which describe how to configure grouping programmatically. The problem with the programmatic approach is it does not run at design-time, and is in conflict with the design-time attributes. I want to use the well supported design-time sample data tool chain, and keep designers free from having to write code.\n  \nWhile Googling for a solution I came across the [new design-time attribute documentation](http://msdn.microsoft.com/en-us/library/ff602277(VS.95).aspx) (note: it applies equally well to WPF in spite of the Silverlight bias!), which included an attribute I had never seen before: `d:DesignSource`. According to MSDN, `d:DesignSource`:\n\n\u003e Specifies a design-time data source for a [CollectionViewSource](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource(v=VS.95).aspx). This makes the designer aware of the shape of your types. This enables you to use the data binding builder to create bindings. \n\nand gives the following example usage:\n\n    \u003cCollectionViewSource x:Key=\"CustomerViewSource\"\n        d:DesignSource=\"{d:DesignInstance local:Customer, CreateList=True}\" /\u003e\n\nThe description was intriguing but after looking at the example it seemed to be mistakenly underselling the capability. The sample code shows that it does more than make the \"designer aware of the shape of your types\" – it’s actually allowing sample data to be injected into a `CollectionViewSource` using the well know `d:DesignInstance` … and presumably `d:DesignData` too.\n\nAs it turns out, the only way to specify the `DataGrid` grouping in XAML is to use the `CollectionViewSource`. I figured by combining `CollectionViewSource` and `d:DesignSource` I could achieve my goals.\n\nAfter some experimentation I got it working exactly as I hoped it would. Here is the code:\n\n        \u003cGrid\u003e\n    \n            \u003cGrid.Resources\u003e\n                \u003cCollectionViewSource x:Key=\"groupedCollectionView\"\n                                      d:DesignSource=\"{d:DesignData Source=./SampleData/BookingRowCollectionSampleData.xaml }\" \n                                      Source=\"{Binding RuntimeBookingRowCollection}\"\u003e\n                    \u003cCollectionViewSource.GroupDescriptions\u003e\n                        \u003cPropertyGroupDescription PropertyName=\"PropertyToGroupBy\"/\u003e\n                    \u003c/CollectionViewSource.GroupDescriptions\u003e\n            \u003c/CollectionViewSource\u003e\n            \u003c/Grid.Resources\u003e\n    \n            \u003cDataGrid AutoGenerateColumns=\"True\"\n                      ItemsSource=\"{Binding Source={StaticResource groupedCollectionView}}\" \u003e\n                \u003cDataGrid.GroupStyle\u003e\n                    \u003cx:Static Member=\"GroupStyle.Default\"/\u003e\n                \u003c/DataGrid.GroupStyle\u003e\n            \u003c/DataGrid\u003e\n    \n        \u003c/Grid\u003e\n\nThere are a couple of things to point out:\n  \n* I used “Create sample data from class…” in Blend to create my `BookingRowCollectionSampleData.xaml`. The class which I generate from was defined below. I found I had to create this specialized collection in order to satisfy the `d:DesignSource`. Conversely my attempt at creating sample data based off my view model which in turn had a collection property was a dead end – `d:DesignSource` needs to be given a raw collection; there is no way to dereference the collection property within a view model. \n    \n        public class BookingRowCollection : List\u003cBookingRow\u003e\n        {\n        }\n  \n* I wanted to make sure that I didn’t need multiple paths in my code behind to handle the differences between design-time and run-time, specifically with binding and MVVM. In this case the design-time “switch” is handled purely within the `CollectionViewSource`, where the Source is set differently depending on what mode we are in. Note that even though the `CollectionViewSource` is a resource, it will still correctly bind to our `RuntimeBookingRowCollection`. \n\nDeclaring the `CollectionViewSource` proxy within your XAML will not suit all MVVM projects as sometimes you might want to define a `CollectionView` within your view model, but it worked in my case because the grouping was never going to change. For this project the grouping can be considered purely part of presentation so I am happy to declare it in XAML, and as a bonus it works beautifully with design-time sample data!\n\nI think this solution will work for Silverlight too, but I have not tested it yet.","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/utorrent-service-windows-home-server-2011":{"title":"Running uTorrent as a Service on Windows Home Server 2011","content":"\n## Step 1: Download and Install uTorrent\n\t\n* [Download uTorrent 2.2.1](http://www.utorrent.com/downloads) (390 KB)\n* Install uTorrent as normal, by opening the downloaded EXE\n* It should install itself into `C:\\Program Files (x86)\\uTorrent`\n\n[ad#Google Adsense #1]\n\n## Step 2: Configure uTorrent Web UI\n\t\n* Run uTorrent as normal (e.g. Start Menu)\n* Go to Options menu and select Preferences\n* Go to the Directories folder and set the folders where you want your torrents to be stored\n    * Make a note of these directories, as you will need them in step 8\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image49.png)\n\t\n* Go to the Web UI section and make three changes\n    * Tick “Enable Web UI”\n    * Set a username and password\n    * Tick “Alternative Listening Port”; leave the number as 8080\n        * Note: This sub-step is not strictly necessary but gives you a higher chance of things working first time\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image50.png)\n\n## Step 3: Test uTorrent Web UI\n\t\n* Using a different computer on the local network ensure you can get to the uTorrent Web UI\n* The web address should of the form [http://homeserver:8080/gui/](http://homeserver:8080/gui/)\n* Note: You **must** replace homeserver in the above URL with the name of the computer where you install uTorrent.\n* The browser should ask for a username and password. Use the values provided in Step 2\n* You should see the uTorrent Web UI.\n* \u003cspan style=\"color: #ff0000;\"\u003e\u003cstrong\u003eIf you do not see the uTorrent Web UI do not proceed any further. You have a networking problem. Seek help.\u003c/strong\u003e \u003c/span\u003e\n* \u003cspan style=\"color: #000000;\"\u003e\u003cstrong\u003eAt this stage you have a working uTorrent Web UI but it is\u003c/strong\u003e \u003cstrong\u003e\u003cspan style=\"text-decoration: underline;\"\u003eNOT \u003c/span\u003e\u003c/strong\u003e\u003cstrong\u003e\u003cspan style=\"text-decoration: underline;\"\u003erunning as a service\u003c/span\u003e. This means that torrents can still only be downloaded when a user is logged on and running uTorrent.\u003c/strong\u003e \u003cstrong\u003eContinue with the following steps to run it as a service…\u003c/strong\u003e\u003c/span\u003e\n\t\n* **Important: Now Close down uTorrent by choosing File-\u0026gt;Exit.**\n\n[ad#Google Adsense #1]\n\n## Step 4: Copy the uTorrent settings file\n\t\n* Copy the settings.dat file from `C:\\Users\\\u003cUser\u003e\\AppData\\Roaming\\uTorrent` to `C:\\Program Files (x86)\\uTorrent`\n\n**Note: Depending on your username you will need to substitute \u003cUser\u003e in the above path**\n\n## Step 5: Download and Install SRVANY.exe\n\t\n* Download [Windows Server 2003 Resource Kit Tools](http://www.microsoft.com/downloads/en/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd) (11.8 MB).\n* Install the entire tool suite as normal, by opening the downloaded exe.\n* By default srvany.exe will be installed to `C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\srvany.exe`\n\n## Step 6: Create Windows Service for uTorrent\n\t\n* Open an \u003cspan style=\"text-decoration: underline;\"\u003e\u003cstrong\u003eadministrative\u003c/strong\u003e\u003c/span\u003e command prompt by following these steps:\n  * Navigate to Start Menu –\u003e Accessories –\u003e Command Prompt\n  * Right click and select \"Run as Administrator\"\n* At the command prompt enter the following:\n\n```dos\nsc create uTorrent binPath= \"C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\srvany.exe\" obj= \"NT AUTHORITY\\LocalService\" start= auto\n```\n\n* **Note: Do not remove the spaces between the equals sign and parameters.** This is an oddity of sc command and is required\n* If this works you should see something like the screenshot below:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image311.png)\n\n**If you get the “Access is denied” error then you are not running as administrator.**\n\n## Step 7: Configure the SRVANY.EXE service\n\t\n* If you want to perform this step manually you will need to know about regedit. Here are the steps:\n* Run regedit\n    * Navigate to `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\uTorrent\\Parameters`\n    * Create the Parameters key if it does not exist\n    * Under the Parameters Key, add a new String Value named Application\n    * Set the value to be `C:\\Program Files (x86)\\uTorrent\\uTorrent.exe`\n    * If you have done everything correctly it should look like the screenshot below:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image51.png)\n\n[ad#Google Adsense #1]\n\n## Step 8: Modify permissions on your downloads directory\n\nBy default Windows will not allow your uTorrent service to read or write to the disk. In order for uTorrent to work you need to add read \u0026amp; write permissions on the directory or directories you **specified in Step 2**.\n\t\n* Navigate to the directory\n* View the directory properties\n* Select the Security tab\n* Click the Edit… button\n* Click the Add… button\n* Enter `LOCAL SERVICE` (including the space) then click OK\n* Ensure \"Allow Modify\" is ticked, and OK everything\n* It should look something like the screeshot below:\n\n![](https://s3-us-west-2.amazonaws.com/jack-ukleja-com/image52.png)\n\n## Step 9: Ensure the uTorrent service is running\n\t\n* Load the services control panel (Start-\u003eRun-\u003eServices.msc)\n* Locate the service named uTorrent and verify the Status column says \"Started\".\n* If it does not say \"Started\", then click the Start Service button\n\n## Finally…\n\t\n* Log off your Windows session and repeat **Step 3** to verify that the web UI is still working and you can download torrents successfully.\n\n## General trouble shooting:\n\t\n* Double check that uTorrent.exe is not running on your desktop.\n    * Note: By default clicking the close button in top right of the uTorrent window will **not** actually exit the application\n* Double check that uTorrent.exe is running as a service.\n    * In task manager, “Show processes from all users”, ensure you can see uTorrent.exe running with LOCAL SERVICE displaying in the User Name column\n* Please leave a comment if you have any issues with this guide\n\n[ad#Google Adsense #1]","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/wcf-data-services-vs-wcf-ria-services":{"title":"WCF Data Services vs WCF RIA Services","content":"\nI’ve been having trouble finding a straight forward comparison of these two technologies. On the surface they appear to be solving similar, if not the same problems.\n  \nMake no mistake – the message coming from Microsoft is not clear or consistent – which probably explains the confusion. I suspect the relationship between these two products is still being “discovered” by MS.\n  \nAnyway, in this [bliki](http://en.wikipedia.org/wiki/Bliki) I will try to sum up my findings as to the differences between them as I figure them out.\n  \u003ctable border=\"0\" cellspacing=\"0\" cellpadding=\"2\" width=\"800\"\u003e\u003ctbody\u003e     \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003e         \u003ch3\u003eWCF (ADO.NET) Data Services\u003c/h3\u003e       \u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003e         \u003ch3\u003eWCF (.NET) RIA Services\u003c/h3\u003e       \u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eExpose data model as RESTful web service\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003ePrescriptive approach to n-tier app development\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eCross platform interoperation as a goal          \u003cbr\u003e- “Unlock data silos”           \u003cbr\u003e- Out-of-box support from future MS products such as SQL2008 R2, Azure, Excel 2010, SharePoint 2010\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eDesigned specifically for end-to-end Silverlight \u0026amp; ASP.NET solutions          \u003cbr\u003e- Some technology proprietary to Silverlight (no WPF support)           \u003cbr\u003e- Use ASP.NET Authentication/Roles across SL and ASP.NET           \u003cbr\u003e- ASP.NET/AJAX can also access service layer\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eLoosely coupled clients and servers\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eClient \u0026amp; server are designed and deployed together\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eService layer exposes “raw” data sources\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eOpportunity to easily add business logic into service layer          \u003cbr\u003e- Encourage “domain” concepts           \u003cbr\u003e- Strong validation framework           \u003cbr\u003e- Offline / Sync enabled\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eService can be consumed from .NET, Silverlight, AJAX, PHP and Java (libraries available)\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eService can be consumed easily from SL, AJAX, WebForms          \u003cbr\u003e\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eService’s data source must:          \u003cbr\u003e- Expose at least one IQueryable property           \u003cbr\u003e- Implement IUpdateable if you desire updates\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eService exposes domain objects via convention:          \u003cbr\u003e- IQueryable GetX           \u003cbr\u003e- UpdateX/InsertX/DeleteX\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eNo design time experience yet (??)\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eDesign time experience with data sources, drag drop etc\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003e- OData for all clients          \u003cbr\u003e- Within OData, multiple formats supported (JSON, XML etc)\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003e- SOAP (binary) for SL clients         \u003cbr\u003e- JSON for AJAX clients          \u003cbr\u003e- SOAP (XML) for other clients          \u003cbr\u003e\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eDiscoverable (?)\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eNon-discoverable\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eHosted as WCF Service (.svc)\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eOld version hosted in custom web handler (.axd).          \u003cbr\u003eNew version is WCF service.\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eStandardized on \u003ca href=\"http://www.odata.org/\"\u003eOData\u003c/a\u003e protocol \u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eWill “support” OData\u003c/td\u003e     \u003c/tr\u003e      \u003ctr\u003e       \u003ctd valign=\"top\" width=\"400\"\u003eMore mature – public for at least 2 years, formerly “Project Astoria”\u003c/td\u003e        \u003ctd valign=\"top\" width=\"400\"\u003eLess mature - public for 6 months\u003c/td\u003e     \u003c/tr\u003e   \u003c/tbody\u003e\u003c/table\u003e \n  \n[ad#Google Adsense #1] \n\n### Common features\n\n* Based on WCF     \n* Use a RESTful architecture     \n* Can be used to expose any data source (sql, xml, poco/objects etc.)    \n* Client side libraries provide ability to query using LINQ \n  \n### General\n   \n* Currently they do not share much (any?) technology / code     \n* RIA Services is not based on top of Data Services     \n* RIA Services \u0026amp; Data Services will “align”    \n* OData eventually pushed down into WCF stack  \n  \nYour opinions are welcome!\n  \n### References\n\nhttp://blogs.msdn.com/brada/archive/2009/03/19/what-is-net-ria-services.aspx\n  \nhttp://mschannel9.vo.msecnd.net/o9/mix/09/pptx/t36f.pptx\n  \nhttp://blogs.msdn.com/endpoint/archive/2009/11/18/the-wcf-services-ecosystem.aspx\n  \nhttp://www.douglaspurdy.com/2009/11/20/on-odata-open-data-protocol/\n  \nhttp://msdn.microsoft.com/en-us/data/ee844254.aspx\n  \nhttp://blogs.msdn.com/saurabh/archive/2009/11/23/understanding-the-wcf-in-wcf-ria-services.aspx\n","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/windows-7-iso-how-to-easily-switch-edition":{"title":"Windows 7 ISO: How to easily switch edition","content":"\nThere have been quite a [few](http://windows7center.com/news/how-to-install-any-version-or-sku-of-windows-7/) [blog](http://www.askvg.com/how-to-choose-desired-windows-7-edition-version-during-setup/) posts about how to manually switch edition of the Windows 7 ISO, for example to change from Ultimate to Home Premium.\n\nWhat I wanted was a program that automated all the steps. I was going to write one myself, but thankfully someone has already released a tool to do just that. The guy responsible is [Kai Liu](http://www.kailiu.com) and in fact he has two programs:\n\n\n\t\n* One to turn your ISO into an “All editions” ISO, just like the RC used to work (**eicfg_removal_utility**)\n\t\n* One to switch ISO editions which results in a “bit perfect” rendition of the original MSDN ISOs, verified against the MSDN hash codes (**windows7_iso_image_edition_switcher**)\n\n\nYou can download them both here: [http://code.kliu.org/misc/win7utils/](http://code.kliu.org/misc/win7utils/)\n\n[](http://code.kliu.org/misc/win7utils/)\n\nHere is the [original neowin post](http://www.neowin.net/forum/index.php?showtopic=809014\u0026amp;st=0\u0026amp;p=591407990\u0026amp;#entry591407990) where he talk about the utilities. For the untrustworthy, both of these utilities come bundled with the source code so you can see exactly what they are doing.\n\nNotes: Both these utilities modify the ISO files in-place (so you don’t need to worry about multiple GB file copies).\n\nOne potential draw back is both programs use dialogs to select the ISOs so you won’t be able to automate use of these utilities in a script very easily.\n\nAs is often the case it can be hard to find the “original” (trustworthy) executables for utilities like this as they get shared widely, copied, and referenced on random forums. Hence after a bit of research I wanted to do my bit to add Google juice to the genuine “[Windows 7 ISO Edition Patching/Switching](http://code.kliu.org/misc/win7utils/)” article.","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":[]},"/workaround-for-visualstatemanager-gotostate-not-working-on-window":{"title":"Workaround for VisualStateManager.GoToState not working on Window","content":"\nI am not sure if this is a bug or what, but I’ve had an annoying problem today whereby it seems you are unable to switch states procedurally using code like this:\n\n    VisualStateManager.GoToState(this, \"MyState\", true);\nwhen your control (the first parameter) is not a UserControl. In my case that control was the top level Window of my WPF application.\n\nThe strange thing is the state switching works fine when I use the **GoToStateAction**.\n\nAfter pouring over the code in Reflector it strikes me that something I don’t yet understand is happening with CustomVisualStateManager which Blend actually sets to be ExtendedVisualStateManager.\n\nIt seems ExtendedVisualStateManager has a method called GoToElementState which allows you to pass in a FrameworkElement, whereas GotToState only allows a Control.\n\nBy trial and error I found that the following code works:\n\n    ExtendedVisualStateManager.GoToElementState(this.LayoutRoot as FrameworkElement, \"MyState\", true);\nwhere Layroot root is a Grid and is the first child of my Window, and is where the actual VisualStateGroups are defined.\n\nIf anyone has an idea what is going on here, and why the GoToState doesn’t work as expected for a Window, please let me know.\n\n\u003cspan style=\"color: #0000ff;\"\u003e\u003cstrong\u003eUpdate: \u003ca href=\"http://connect.microsoft.com/Expression/feedback/ViewFeedback.aspx?FeedbackID=509740#details\"\u003eAccording to a comment from Steve at Microsoft\u003c/a\u003e, this issue will be fixed when the Visual State Manager gets integrated into .NET Base Class Libraries (BCL) e.g. when WPF 4.0 is released.\u003c/strong\u003e\u003c/span\u003e","lastmodified":"2023-07-22T09:12:47.227134013Z","tags":["wpf"]}}